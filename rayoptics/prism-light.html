<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Prism Light Dispersion Simulator</title>
<style>
    * {margin:0;padding:0;box-sizing:border-box;font-family:sans-serif;}
    body {background:black;color:white;padding:20px;}
    canvas {display:block;margin:0 auto;background:#111;border-radius:10px;}
    .controls {width:700px;margin:20px auto;text-align:center;}
    input[type="range"] {width:300px;}
    .label {margin:10px;}
</style>
</head>
<body>
<canvas id="c" width="700" height="500"></canvas>
<div class="controls">
    <div class="label">Prism Angle: <span id="aVal">60</span>°</div>
    <input id="a" type="range" min="30" max="80" value="60"><br>
    <div class="label">Refractive Index: <span id="nVal">1.52</span></div>
    <input id="n" type="range" min="1.3" max="1.8" step="0.01" value="1.52"><br>
    <div class="label">Incidence Angle: <span id="iVal">45</span>°</div>
    <input id="i" type="range" min="0" max="80" value="45">
</div>
<script>
const canvas = document.getElementById('c');
const ctx = canvas.getContext('2d');

let prismAngle = 60, refractiveIndex = 1.52, incidentAngle = 45;

const colors = [
  {name:'violet', rgb:'#8B00FF', n:1.53},
  {name:'indigo', rgb:'#4B0082', n:1.52},
  {name:'blue', rgb:'#0000FF', n:1.51},
  {name:'green', rgb:'#00FF00', n:1.50},
  {name:'yellow', rgb:'#FFFF00', n:1.49},
  {name:'orange', rgb:'#FF7F00', n:1.48},
  {name:'red', rgb:'#FF0000', n:1.47}
];

function draw(){
    ctx.fillStyle='black';
    ctx.fillRect(0,0,canvas.width,canvas.height);

    const cx=canvas.width/2, cy=canvas.height/2;
    const size=150;
    const angleRad = prismAngle*Math.PI/180;
    const halfAngle = angleRad/2;

    // Prism vertices
    const top={x:cx, y:cy - size*Math.cos(halfAngle)};
    const left={x:cx - size*Math.sin(halfAngle), y:cy + size*Math.cos(halfAngle)};
    const right={x:cx + size*Math.sin(halfAngle), y:cy + size*Math.cos(halfAngle)};

    // Draw prism
    ctx.fillStyle='rgba(255,255,255,0.1)';
    ctx.strokeStyle='white';
    ctx.lineWidth=2;
    ctx.beginPath();
    ctx.moveTo(top.x, top.y);
    ctx.lineTo(left.x, left.y);
    ctx.lineTo(right.x, right.y);
    ctx.closePath();
    ctx.fill();
    ctx.stroke();

    // Light source
    const sx=left.x - 150, sy=cy;
    ctx.fillStyle='white';
    ctx.beginPath(); ctx.arc(sx, sy,5,0,2*Math.PI); ctx.fill();

    colors.forEach((color, idx)=>{
        const n=color.n;
        const iRad = incidentAngle*Math.PI/180;

        // Prism normal vector at entry
        const normalAngle = Math.PI/2 - halfAngle;
        const theta1 = iRad; // incident
        const theta2 = Math.asin(Math.sin(theta1)/n); // inside prism

        // Entry point
        const entryX = left.x; 
        const entryY = left.y - (left.y-top.y)/2;

        // Inside prism direction
        const internalAngle = -halfAngle + theta2;

        const internalLength = Math.hypot(right.x - top.x, right.y - top.y);
        const intX = entryX + internalLength*Math.cos(internalAngle);
        const intY = entryY + internalLength*Math.sin(internalAngle);

        // Draw incident ray
        ctx.strokeStyle='white';
        ctx.lineWidth=2;
        ctx.beginPath();
        ctx.moveTo(sx, sy);
        ctx.lineTo(entryX, entryY);
        ctx.stroke();

        // Draw internal ray
        ctx.strokeStyle=color.rgb;
        ctx.lineWidth=2;
        ctx.beginPath();
        ctx.moveTo(entryX, entryY);
        ctx.lineTo(intX,intY);
        ctx.stroke();

        // Emergence using Snell's law at second face
        const exitAngle = Math.asin(n*Math.sin(internalAngle)); // approximate
        const exitLength = 200;
        const ex = intX + exitLength*Math.cos(exitAngle);
        const ey = intY + exitLength*Math.sin(exitAngle);

        // Draw emergent ray
        ctx.strokeStyle=color.rgb;
        ctx.lineWidth=2;
        ctx.beginPath();
        ctx.moveTo(intX,intY);
        ctx.lineTo(ex,ey);
        ctx.stroke();
    });

    // Draw screen
    ctx.strokeStyle='white';
    ctx.lineWidth=2;
    ctx.beginPath();
    ctx.moveTo(canvas.width-50,100);
    ctx.lineTo(canvas.width-50,400);
    ctx.stroke();
}

draw();

// Sliders
document.getElementById('a').oninput = (e)=>{ prismAngle=parseInt(e.target.value); document.getElementById('aVal').textContent=prismAngle; draw(); };
document.getElementById('n').oninput = (e)=>{ refractiveIndex=parseFloat(e.target.value); document.getElementById('nVal').textContent=refractiveIndex.toFixed(2); draw(); };
document.getElementById('i').oninput = (e)=>{ incidentAngle=parseInt(e.target.value); document.getElementById('iVal').textContent=incidentAngle; draw(); };
</script>
</body>
</html>
